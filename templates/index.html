[[extend 'layout.html']]

<style>
  [v-cloak] {
       display: none;
  }
</style>

<style>
  .box:not(.modal-box):hover {
  background-color: lightblue; /* Customize the highlight color */
  border: 1px solid lightblue; /* Customize the border color */
  }
</style>




<div class="section" id="vue-target">
  <button class="button is-link" @click="interonly">FILTER TO INTEREESTS</button>


  <!--Section for Search bar -->
  <div class="columns">
    <div class="column is-7">
      <p class="control has-icons-right">
        <input class="input is-rounded is-medium" type="text" v-model="query" @keydown="search" placeholder="Species">
        <span class="icon is-small is-right is-clickable" @click="clear_search">
          <i class="fa fa-times-circle"></i>
        </span>
      </p>
    </div>
  <!--Section for Search bar results -->
  </div>
  
  <div class="field" v-for="result in search_results">
    <div class="column is-7">
      <div class="box" @click="popup(result)">
        <div class="media">
          <div class="media-left">
            <figure class="image">
              <img :src="result.image_url" :alt="result.species_guess" style="height: 64px; width: 64px;"/>
            </figure>
          </div>
          <div class="media-content">
            <p class="title is-5">{{result.common_name}}</p>
            <p class="title is-6"><i>{{result.scientific_name}}</i></p>
          </div>
          <div class="media-right is-centered">
            <button class="button is-hoverable is-centered" @click.stop="add_interest(result)">Add Interest</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Section for pop-up-->
  <div v-if="clicked_observation" class="modal is-active">
    <div class="modal-background" @click="depop"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title is-size-3">{{ clicked_observation.common_name }}
          <span class="is-size-6"> ({{ clicked_observation.scientific_name }})</span>
        </p>
        <button class="delete" aria-label="close" @click="depop"></button>
      </header>
      <section class="modal-card-body">
        <div class="columns">
          <div class="column is-6">
            <img :src="clicked_observation.image_url" :alt="clicked_observation.species_guess" style="height: 326px; width: 312px;"/>
          </div>
          <div class="column is-6">
            <div class="box modal-box" style="width: 300px; height: 150px;">
              <h1 class="is-size-3 is-flex is-align-items-center">Location</h1>
              <p class="is-size-5 is-flex">{{clicked_observation.longitude}} {{clicked_observation.latitude}}</p>
            </div>
            <div  class="box modal-box" style="width: 300px; height: 150px;">
              <h2 class="is-size-3 is-flex is-align-items-center">iNat url</h2>
            </div>
          </div>
        </div>
        <p class="is-size-3"> Field Notes</p>
        <div class="field">
          <textarea class="textarea m-1" id="noteTitle" placeholder="Title your notes!" rows="1"></textarea>
          <textarea class="textarea m-1" id="noteContent" placeholder="Share your notes!" rows="3"></textarea>
          <button class="button is-fullwidth is-success m-1" @click="post_note(clicked_observation.url, clicked_observation.longitude, clicked_observation.latitude, clicked_observation)" class="button is-success">publish</button>
        </div>
        <div v-if="notes.length <= 0">
          <p class="is-size-5">No current field notes for this observation.</p>
        </div>
        <div v-else>
          <div class="box modal-box" v-for="note in notes">
            <nav class="level is-mobile">
              <div class="level-left">
                <span class="is-size-5">{{note.title}}</span>
                
              </div>
              <div class="level-right">
                <span class="level-item">
                  {{note.created_on}}
                </span>
              </div>
            </nav>
            <div class="content" style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
              {{note.notes}} 
            </div>
            <nav class="level is-mobile">
              <div class="level-left">

              </div>
            </nav>
          </div>
        </div>
        
      </section>
        
        <!-- Include additional information as needed -->
    </div>
    
  </div>
    <!--Section for Goolge Maps -->
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <div class="column">
  
    <title>Simple Map</title>
      <div class="section" id="map"></div>
    </div>
    <title>Fnote Map</title>
      <div class="section" id="map2"></div>
    </div>
    <div class="block">
      <div class="section" id="vue-target">
        <div class="has-text-weight-bold is-size-3">TESTINGG</div>
      </div>
    </div>

</div>
  

[[block page_scripts]]
<script>
  let post_note_url = "[[=XML(post_note_url)]]"
  let observations_url = "[[=XML(observations_url)]]"
  let search_url = "[[=XML(search_url)]]"
  let add_interest_url = "[[=XML(add_interest_url)]]"
  let maps_api_key = "[[=XML(MAPS_API_KEY)]]"
  let getfieldnotes_url = "[[=XML(getfieldnotes_url)]]"
  let field_note_url = "[[=XML(field_notes_url)]]"
</script>
<script type="module" src="js/index.js"></script>
<script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
<script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
  ({key: "[[=XML(MAPS_API_KEY)]]", v: "beta"});</script>
<script type="module" src="js/index.js"></script>
[[end]]



 
